var tocId="#toc";var flagId="#tocFlag";var post={appreciateModel:function(){$(".appreciate-btn").on("click",function(e){$(".qr-code-wrap").velocity("transition.expandIn",{duration:300});$(document).one("click",function(){$(".qr-code-wrap").velocity("transition.expandOut",{duration:300})});e.stopPropagation()})},toggleSocialShare:function(){$(".share-btn").on("click",function(e){var icons=$("#socialShare");if(icons.hasClass("show")){$("#socialShare").velocity("transition.slideUpOut",{duration:300})}else{$("#socialShare").velocity("transition.slideDownIn",{duration:300})}icons.toggleClass("show")})},appreciate:function(){$(".qr-code").on("click",function(e){e.stopPropagation()});$(".closinglayer").on("click",function(e){$(".qr-code-wrap").velocity("transition.expandOut",{duration:300})});$(".zfb-btn").on("click",function(e){$(".qr_code_zfb").css("height","300px");$(".qr_code_wx").css("height","0")});$(".wx-btn").on("click",function(e){$(".qr_code_wx").css("height","300px");$(".qr_code_zfb").css("height","0")})},removeFirstUL:function(){var post_content=document.getElementById("post-content");if(!post_content){return}var firstNodeName=post_content.firstElementChild.nodeName;if(firstNodeName==="UL"){$(post_content.firstElementChild).hide()}},getScrollTop:function(){return document.documentElement.scrollTop||document.body.scrollTop},tocScroll:function(event){var Obj=$(flagId);if(Obj.length!==1){return false}var tocFixed=$(tocId);var ObjTop=Obj.offset().top-$(window).height()*.5;var scrollTop=post.getScrollTop();var postHeaderHeight=$("#postHeader").height();if(scrollTop>postHeaderHeight){tocFixed.show()}else{tocFixed.hide()}var tocEle=document.querySelector(tocId);if(!tocEle||!tocEle.getBoundingClientRect()){return}var tocHeight=tocEle.getBoundingClientRect().height;if(scrollTop>ObjTop-tocHeight*.5){tocFixed.addClass("right-fixed")}else{tocFixed.removeClass("right-fixed")}post.tocParentActive();event.preventDefault()},scrollTocFixed:function(){window.addEventListener("scroll",post.tocScroll,false)},initToc:function(){var headerEl="h1,h2,h3,h4,h5,h6",content=".post-content";tocbot.init({tocSelector:"#toc",contentSelector:content,headingSelector:headerEl,scrollSmooth:true,headingsOffset:0-$("#postHeader").height(),hasInnerContainers:false});var tocLinks=$(".toc-link");if(tocLinks){for(var i=0;i<tocLinks.length;i++){var tocLink=tocLinks[i];tocLink.after(document.createElement("span"))}}},readProgress:function(){var $content=$("#main");var $readProgressBar=$("#readProgress .read-progress-bar");var changeReadProgress=function(){var contentHeight=$content.height()-window.innerHeight;if(contentHeight<=0)return;var readHeight=window.pageYOffset-$content.offset().top;var progressWidth=readHeight/contentHeight*100+"%";$readProgressBar.width(progressWidth)};displayReadProgress&&changeReadProgress();$(window).on("scroll",function(){displayReadProgress&&changeReadProgress()})},initViewer:function(){if(document.getElementById("post-content")){new Viewer(document.getElementById("post-content"),{toolbar:false})}},loadHighlight:function(){var codes=document.querySelectorAll(".post-page pre code");for(var i=0;i<codes.length;i++){var block=codes[i];hljs.highlightBlock(block);$("code.hljs").each(function(i,block){hljs.lineNumbersBlock(block)})}},tocHover:function(){$(".toc-list-item span").hover(function(){$(this).parent().find("a.toc-link:first").addClass("toc-hover")},function(){$(this).parent().find("a.toc-link:first").removeClass("toc-hover")})},tocParentActive:function(){var isCollapsible=$(".is-active-li").parents("ol.toc-list.is-collapsible");if(isCollapsible){isCollapsible.each(function(){$(this).parent().find("a.toc-link:first").addClass("toc-hover")})}var isCollapsed=$("ol.toc-list.is-collapsible.is-collapsed");if(isCollapsed){isCollapsed.each(function(){$(this).parent().find("a.toc-link:first").removeClass("toc-hover")})}},shareIcon:function(){var $config={sites:["google","twitter","facebook","weibo","qq","tencent","qzone","linkedin","wechat","douban","diandian"],disabled:socialDisabled.split(",")};socialShare(".social-share",$config)}};$(function(){post.appreciate();post.initToc();post.removeFirstUL();post.scrollTocFixed();post.readProgress();post.loadHighlight();post.appreciateModel();post.toggleSocialShare();post.initViewer();post.tocHover()});